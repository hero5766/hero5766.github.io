---
title: 四元素
author: hero576
tags:
  - algorithm
categories:
  - math
date: 2021-05-22 11:27:00
---
# 四元素[^1][^2][^3][^4]
[^1]:[四元数基础（一） - shared_ptr - 博客园 (cnblogs.com)](https://www.cnblogs.com/tchenai/p/9767510.html)
[^2]:[四元数基础（二） - shared_ptr - 博客园 (cnblogs.com)](https://www.cnblogs.com/tchenai/p/9775269.html)
[^3]:[点的旋转（4）：四元数的乘法_ayww的博客-CSDN博客_四元数的乘法](https://blog.csdn.net/u011760195/article/details/85382640)
[^4]:[四元数和旋转(Quaternion & rotation)](https://www.cnblogs.com/leixinyue/p/13469155.html)

# 引入四元素
- 假设有两个复数：`$\begin{cases}A=a+bi\\C=c+di\end{cases}$`，在引入一个虚部j，定义：`$Q=A+Cj$`，并定义：`$k=ij$`，可得：`$Q=a+bi+cj+dk\in\mathbb{H}$`
- 另一种表示，复数`$z=a_bi$`表示复平面内一个点，坐标为`$(a,b)$`，四元数也可以表示为`$Q=a+bi+cj+dk\Longleftrightarrow q_w+q_v$`
    - 其中，`$q_w$`为实部，`$q_v=q_xi+q_yj+q_zk=(q_x,q_y,q_z)$`为虚部
- 将四元数Q记作四维空间向量q，则可以写为：`$q=\begin{bmatrix}q_w\\q_v\end{bmatrix}=\begin{bmatrix}q_w\\q_x\\q_y\\q_z\end{bmatrix}$`

# 虚部的运算
- `$i^2=j^2=k^2=ijk=-1\\ij=-ji=k\\jk=-kj=i\\ki=-ik=j$`
- 实数，虚数，复数本质都是四元数：`$\\a\in\mathbb{H}\\bi\in\mathbb{I}\in\mathbb{H}\\a+bi\in\mathbb{Z}\in\mathbb{H}$`

# 纯虚四元数
- `$Q=bi+cj+dk\in\mathbb{H}_p\subset\mathbb{H}$`


# 性质

运算|公式|说明
-|-|-
加法|`$p\pm q=\begin{bmatrix}p_w\\p_v\end{bmatrix}\pm\begin{bmatrix}q_w\\q_v\end{bmatrix}=\begin{bmatrix}p_w\pm  q_w\\p_v\pm q_v\end{bmatrix}$`|交换律:`$p+q=q+p$`<br>结合律：`$p+(q+r)=(p+q)+r$`
乘积|`$p\otimes q=(q_w+q_xi+q_yj+q_zk)\otimes(p_w+p_xi+p_yj+p_zk)\\=\begin{bmatrix}p_wq_w-p_xq_x-p_yq_y-p_zq_z\\p_wq_x+p_xq_w+p_yq_z-p_zq_y\\p_wq_y-p_xq_z+p_yq_w+p_zq_x\\p_wq_z+p_xq_y-p_yq_x+p_zq_w\\\end{bmatrix}\\=\begin{bmatrix}p_wq_w-p_v^Tq_v\\p_wq_v+q_wp_v+p_v\times q_v\end{bmatrix}\\=\begin{bmatrix}p_w&-p_x&-p_y&-p_z\\p_x&p_w&-p_z&p_y\\p_y&p_z&p_w&-p_x\\p_z&-p_y&p_x&p_w\\\end{bmatrix}\begin{bmatrix}q_w\\q_x\\q_y\\q_z\end{bmatrix}\\=p_Lq\\=\begin{bmatrix}q_w&-q_x&-q_y&-q_z\\q_x&q_w&q_z&-q_y\\q_y&-q_z&q_w&q_x\\q_z&q_y&-q_x&q_w\\\end{bmatrix}\begin{bmatrix}p_w\\p_x\\p_y\\p_z\end{bmatrix}\\=q_Rp$`|不满足交换律`$q\otimes p=\neq p\otimes q$`<br>结合律：`$(q\otimes p)\otimes r=q\otimes (p\otimes r)$`<br>分配率：`$q\otimes (p+r)=q\otimes p+q\otimes r$`<br>`$p_Rq_L=q_Lp_R$`
共轭|`$q^*=q_w-q_v=\begin{bmatrix}q_w\\-q_v\end{bmatrix}\\q^*\otimes q=q\otimes q^*=\begin{bmatrix}q_w^2+q_x^2+q_y^2+q_z^2\\0_v\end{bmatrix}\\(p\otimes q)^*=q^*\otimes p^*$`|
模|`$\|q\|=\sqrt{q\otimes q^*}=\sqrt{q^*\otimes q}=\sqrt{q_w^2+q_x^2+q_y^2+q_z^2}$`|
逆|`$q^{-1}\otimes q=1\\q^{-1}=\frac{q^*}{\|q\|^2}$`|

# 单位四元数
- 模长为1的四元数`$\|q\|=1$`，这样限制其刚好三个自由度，用于三维空间的旋转。任意单位四元素总可以表达成下面的形式：`$\\q=\begin{bmatrix}\cos{\theta}\\u\sin{\theta}\end{bmatrix}$`
    - 其中：`$u=u_xi+u_yj+u_zk$`是单位矢量，`$\theta$`是标量
    - 由于是单位四元数：`$q^{-1}=\frac{q^*}{\|q\|^2}=q^{*}$`
    
 
> 三维空间的旋转的表达：
> - 欧拉角：Yaw, Pitch, Roll，共三个自由度；
> - 旋转矩阵：虽然这是个3维方阵，貌似有9个自由度，但它本身也受到正交性等限制。它也只有三个自由度；
> - 旋转向量：旋转方向向量只有两个自由度，外加一个旋转角度，所以，它也肯定是三个自由度；
> - 单位四元数：当一个四元数被限制为单位四元数时，它也只剩下了三个自由度，我们可以用它来表达旋转。

# 单位纯虚四元数
- 四元数`$q=[0,u_x,u_y,u_z]^T\in\mathbb{H}_p$`，`$\|q\|=1$`，可得：`$q\otimes q=-1$`



# 指数映射


# 对数映射

# 球面插值

# 


















