<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="RUST"><meta name="keywords" content="language"><meta name="author" content="hero576"><meta name="copyright" content="hero576"><title>RUST | void land space</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.8.2"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5ff8fca367285c16c6dd5c16ca2ccc1b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.0.2'
} </script><meta name="generator" content="Hexo 5.0.2"><link rel="alternate" href="/atom.xml" title="void land space" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text"> 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text"> 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.2.</span> <span class="toc-text"> 环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ubuntu"><span class="toc-number">1.3.</span> <span class="toc-text"> ubuntu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E4%B8%8B%E8%BD%BD%E9%93%BE%E6%8E%A5"><span class="toc-number">1.4.</span> <span class="toc-text"> windows:下载链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hello-world"><span class="toc-number">1.5.</span> <span class="toc-text"> hello-world</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cargo"><span class="toc-number">2.</span> <span class="toc-text"> cargo</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">3.</span> <span class="toc-text"> 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B1%9E%E6%80%A7"><span class="toc-number">3.1.</span> <span class="toc-text"> 基本属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text"> 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%89%87slices"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 切片slices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 结构体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">3.2.4.</span> <span class="toc-text"> 枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#option"><span class="toc-number">3.2.5.</span> <span class="toc-text"> Option</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vector"><span class="toc-number">3.2.6.</span> <span class="toc-text"> vector</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashmap"><span class="toc-number">3.2.7.</span> <span class="toc-text"> hashmap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text"> 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-number">3.4.</span> <span class="toc-text"> 注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E6%B5%81"><span class="toc-number">3.5.</span> <span class="toc-text"> 控制流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if"><span class="toc-number">3.5.1.</span> <span class="toc-text"> if</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loop"><span class="toc-number">3.5.2.</span> <span class="toc-text"> loop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#while"><span class="toc-number">3.5.3.</span> <span class="toc-text"> while</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#for"><span class="toc-number">3.5.4.</span> <span class="toc-text"> for</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#match"><span class="toc-number">3.5.5.</span> <span class="toc-text"> match</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E6%9D%83"><span class="toc-number">4.</span> <span class="toc-text"> 所有权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%92%8C%E6%A0%88"><span class="toc-number">4.1.</span> <span class="toc-text"> 堆和栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">4.2.</span> <span class="toc-text"> 变量作用域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">4.2.1.</span> <span class="toc-text"> 函数的作用域：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%8B%B7%E8%B4%9D"><span class="toc-number">4.2.2.</span> <span class="toc-text"> 移动和拷贝</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E5%92%8C%E5%80%9F%E7%94%A8"><span class="toc-number">4.3.</span> <span class="toc-text"> 引用和借用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%85"><span class="toc-number">4.4.</span> <span class="toc-text"> 包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97"><span class="toc-number">4.4.1.</span> <span class="toc-text"> 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crate"><span class="toc-number">4.4.2.</span> <span class="toc-text"> crate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mod%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">4.4.3.</span> <span class="toc-text"> mod的结构体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E5%BA%93"><span class="toc-number">4.4.4.</span> <span class="toc-text"> 外部库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%99%E8%AF%AF"><span class="toc-number">4.5.</span> <span class="toc-text"> 错误</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#panic"><span class="toc-number">4.5.1.</span> <span class="toc-text"> panic!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rust_backtrace"><span class="toc-number">4.5.2.</span> <span class="toc-text"> RUST_BACKTRACE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resultte"><span class="toc-number">4.5.3.</span> <span class="toc-text"> Result&lt;T,E&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E4%BC%A0%E9%80%92"><span class="toc-number">4.5.4.</span> <span class="toc-text"> 错误传递</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">4.6.</span> <span class="toc-text"> 测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B"><span class="toc-number">5.</span> <span class="toc-text"> 泛型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B"><span class="toc-number">5.1.</span> <span class="toc-text"> 使用泛型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%B9%E5%BE%81trait"><span class="toc-number">6.</span> <span class="toc-text"> 特征trait</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">6.1.</span> <span class="toc-text"> 使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">7.</span> <span class="toc-text"> 生命周期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">8.</span> <span class="toc-text"> 迭代器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88"><span class="toc-number">9.</span> <span class="toc-text"> 智能指针</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text"> 线程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.</span> <span class="toc-text"> 面向对象</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E5%BE%81"><span class="toc-number">12.</span> <span class="toc-text"> 高级特征</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/images/haimianbaobao.jpg"></div><div class="author-info__name text-center">hero576</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">84</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">17</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">10</span></a></div></div></div><div id="content-outer"><div class="plain" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">void land space</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">主页</a><a class="site-page" href="/archives">文章</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/gallery">相册</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div></div><div class="layout" id="content-inner"><article id="post"><div class="plain" id="post-title">RUST</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-19</time><span class="post-meta__separator">|</span><i class="fa fa-inbox" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/programming/"> programming</a></div><div class="article-container" id="post-content"><blockquote></blockquote>
<a id="more"></a>
<p>[toc]</p>
<h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1>
<h2 id="介绍"><a class="markdownIt-Anchor" href="#介绍"></a> 介绍</h2>
<ul>
<li>开始是私人项目，专注于安全。后公司资助，2015年发布第一版。</li>
<li><a target="_blank" rel="noopener" href="https://kaisery.github.io/trpl-zh-cn/ch01-01-installation.html">Rust 程序设计语言 简体中文版</a></li>
<li><a target="_blank" rel="noopener" href="https://www.rust-lang.org/">官方网址</a></li>
</ul>
<h2 id="环境搭建"><a class="markdownIt-Anchor" href="#环境搭建"></a> 环境搭建</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.rust-lang.org/learn/get-started">官方地址</a></li>
</ul>
<h2 id="ubuntu"><a class="markdownIt-Anchor" href="#ubuntu"></a> ubuntu</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ curl --proto <span class="string">&#x27;=https&#x27;</span> --tlsv1.2 https://sh.rustup.rs -sSf | sh</span><br><span class="line"><span class="built_in">source</span> ~/.barch_profile</span><br><span class="line">rustc --version</span><br></pre></td></tr></table></figure>
<h2 id="windows下载链接"><a class="markdownIt-Anchor" href="#windows下载链接"></a> windows:<a target="_blank" rel="noopener" href="https://static.rust-lang.org/rustup/dist/x86_64-pc-windows-msvc/rustup-init.exe">下载链接</a></h2>
<h2 id="hello-world"><a class="markdownIt-Anchor" href="#hello-world"></a> hello-world</h2>
<ul>
<li>建立工程：<code>cargo new hello</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//hello/src/main.rs</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>运行：<code>cargo run</code></li>
</ul>
<h1 id="cargo"><a class="markdownIt-Anchor" href="#cargo"></a> cargo</h1>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>new</td>
<td>创建工程，<code>cargo new project</code><br>–lib创建库，<code>cargo new --lib libname</code></td>
</tr>
<tr>
<td>run</td>
<td>运行工程，在项目目录下运行：<code>cargo run</code></td>
</tr>
<tr>
<td>build</td>
<td>编译工程</td>
</tr>
<tr>
<td>check</td>
<td>检查工程</td>
</tr>
<tr>
<td>test</td>
<td>测试</td>
</tr>
</tbody>
</table>
<h1 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念"></a> 基本概念</h1>
<h2 id="基本属性"><a class="markdownIt-Anchor" href="#基本属性"></a> 基本属性</h2>
<ul>
<li>变量定义： <code>let name: type</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a =<span class="number">1</span>;<span class="built_in">println!</span>(<span class="string">&quot;a=&#123;&#125;&quot;</span>,a);<span class="comment">//不可变变量</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>可变性</td>
<td>默认不可变：<code>let a=1;</code><br>可变：<code>let mut a=1;</code></td>
</tr>
<tr>
<td>常量</td>
<td><code>const MAX_POINTS:u32=10000;</code></td>
</tr>
<tr>
<td>隐藏</td>
<td>定义重名变量，则会覆盖前一个<code>let a=1;let a:f32=1.1;</code></td>
</tr>
</tbody>
</table>
<h2 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h2>
<ul>
<li>rust是静态语言，在编译前要确定变量类型，编译器有自动推导的能力。</li>
</ul>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bool</td>
<td><code>let a:bool=true;let b:bool=false;</code></td>
</tr>
<tr>
<td>char</td>
<td>字符型是32位的，与其他语言不同，所以可以是一个汉字<br><code>let a='a';let b='一';</code></td>
</tr>
<tr>
<td>数字</td>
<td>i:8,16,32,64;u:8,16,32,64;f:32,64;<br><code>let c:i8=-11;</code></td>
</tr>
<tr>
<td>数组</td>
<td>方括号[type;size]其中size也是数组类型的一部分<br><code>let arr:[u32;5]=[1,2,3,4,5];println!(&quot;arr[0]=&#123;&#125;&quot;,arr[0]);</code></td>
</tr>
<tr>
<td>自适应类型</td>
<td>isize,usize大小根机器位数有关<br><code>println!(&quot;max=&#123;&#125;&quot;,usize::max_value());</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>复合数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>元组</td>
<td>圆括号<code>let tup:(i32,f32,char)=(-3,3.2,'123');let (x,y,z)=tup;</code></td>
</tr>
<tr>
<td>结构体</td>
<td></td>
</tr>
<tr>
<td>枚举</td>
<td></td>
</tr>
<tr>
<td>字典</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="字符串"><a class="markdownIt-Anchor" href="#字符串"></a> 字符串</h3>
<table>
<thead>
<tr>
<th>操作</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>创建空字符串</td>
<td><code>let mut s=String::new();</code></td>
</tr>
<tr>
<td>创建有初值</td>
<td><code>let mut s=String::from(&quot;hello&quot;);</code><br>通过字面值<code>let mut s=&quot;hello&quot;.to_string();</code></td>
</tr>
<tr>
<td>更新</td>
<td>push_str：<code>s.push_str(&quot; world&quot;);s.push_str(&amp;s0);</code><br>push：<code>s.push('!')</code>只能添加一个字符<br>+：<code>let s3=s1+&amp;s2;</code>,s1所有权给了s3<br>format!：<code>let s=format!(&quot;&#123;&#125;-&#123;&#125;&quot;,s1,s2);</code>不会获取所有权</td>
</tr>
<tr>
<td>索引</td>
<td>String：<code>let s2=s[0];</code>报错，rust不支持被索引，防止utf8边界错误<br>str：<code>let s=&quot;你好&quot;;let h=&amp;hello[0..3];</code>，边界不同也会报错</td>
</tr>
<tr>
<td>遍历</td>
<td>chars：<code>for c in s.chars()&#123;println!();&#125;</code><br>bytes：<code>for c in s.bytes()&#123;println!();&#125;</code></td>
</tr>
<tr>
<td>析构</td>
<td>离开作用域会调用<code>drop</code>，释放内存</td>
</tr>
</tbody>
</table>
<ul>
<li>单引号：字符</li>
<li>双引号：表示引用</li>
</ul>
<h3 id="切片slices"><a class="markdownIt-Anchor" href="#切片slices"></a> 切片slices</h3>
<ul>
<li>字符串</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1=<span class="symbol">&#x27;hello</span>&#x27;; <span class="comment">//字面值，不可变</span></span><br><span class="line"><span class="keyword">let</span> s=<span class="built_in">String</span>::from(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> h=&amp;s[<span class="number">0</span>..<span class="number">5</span>];  <span class="comment">// 指向s的0-5的空间</span></span><br><span class="line"><span class="keyword">let</span> h=&amp;s[<span class="number">0</span>..=<span class="number">4</span>];  <span class="comment">// 指向s的0-5的空间</span></span><br><span class="line"><span class="keyword">let</span> h=&amp;s[..<span class="number">5</span>];  <span class="comment">// 指向s的0-5的空间</span></span><br><span class="line"><span class="keyword">let</span> h=&amp;s[..=<span class="number">4</span>];  <span class="comment">// 指向s的0-5的空间</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;h=&#123;&#125;&quot;</span>,h);</span><br><span class="line"><span class="keyword">let</span> w=&amp;s[<span class="number">6</span>..<span class="number">11</span>];</span><br><span class="line"><span class="keyword">let</span> w=&amp;s[<span class="number">6</span>..];</span><br><span class="line"><span class="keyword">let</span> w=&amp;s[..];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ss=<span class="built_in">String</span>::from(<span class="string">&quot;你好&quot;</span>); </span><br><span class="line"><span class="keyword">let</span> w1=&amp;ss[<span class="number">0</span>..<span class="number">2</span>]; <span class="comment">// error，slince必须在有效的utf-8字节边界，否则报错</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;w=&#123;&#125;&quot;</span>,w);</span><br></pre></td></tr></table></figure>
<ul>
<li>数组</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> ss= &amp;a[<span class="number">1</span>..<span class="number">3</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;ss=&#123;&#125;&quot;</span>,ss[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;len ss: &#123;&#125;&quot;</span>,ss.len());</span><br></pre></td></tr></table></figure>
<h3 id="结构体"><a class="markdownIt-Anchor" href="#结构体"></a> 结构体</h3>
<table>
<thead>
<tr>
<th>操作</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>定义</td>
<td><code>struct User&#123;name:String,count String,nonce:u64,active:bool&#125;</code></td>
</tr>
<tr>
<td>实例</td>
<td><code>let mut xiao=User&#123;name:String::from(&quot;xiao&quot;),count:String::from(&quot;8454&quot;),nonce:1000,active:true,&#125;</code></td>
</tr>
<tr>
<td>修改字段</td>
<td>前提是mut可变变量<code>xiao.nonce=2000;</code></td>
</tr>
<tr>
<td>参数名字和字段名同名时可简写</td>
<td><code>let name=String::from(&quot;xiao&quot;);let count=String::from(&quot;80808&quot;);nonce=1000;active=true;let xiao=User&#123;name,count,nonce,active&#125;;</code></td>
</tr>
<tr>
<td>从其他结构体创建实例</td>
<td><code>let xiao2=User&#123;name:String::from(&quot;xiao2&quot;),..xiao&#125;;//此时xiao被借用</code></td>
</tr>
<tr>
<td>元祖结构体</td>
<td>字段没有名字，圆括号<code>struct Point(i32,i32); let a=Point(10,20);println!(&quot;a.x=&#123;&#125;,a.y=&#123;&#125;&quot;,a.0,a.1);</code></td>
</tr>
<tr>
<td>没有任何字段的类单元结构体</td>
<td><code>struct A&#123;&#125;;</code></td>
</tr>
<tr>
<td>打印结构体</td>
<td><code>#[derive(Debug)]</code><br><code>println!(&quot;xiao=&#123;:?&#125;&quot;,xiao);</code><br><code>println!(&quot;xiao=&#123;:#?&#125;&quot;,xiao);</code></td>
</tr>
</tbody>
</table>
<ul>
<li>方法</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dog</span></span>&#123;</span><br><span class="line">  name:<span class="built_in">String</span>,</span><br><span class="line">  weight:<span class="built_in">f32</span>,</span><br><span class="line">  height:<span class="built_in">f32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Dog&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_name</span></span>(&amp;<span class="keyword">self</span>)-&gt;&amp;<span class="built_in">str</span>&#123;</span><br><span class="line">    &amp;(<span class="keyword">self</span>.name[..])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_weight</span></span>(&amp;<span class="keyword">self</span>)-&gt;<span class="built_in">f32</span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.weight</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_height</span></span>(&amp;<span class="keyword">self</span>)-&gt;<span class="built_in">f32</span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.height</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">show</span></span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;owfo&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Dog&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">show2</span></span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;owfo2&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> d = Dog&#123;</span><br><span class="line">    name:<span class="built_in">String</span>::from(<span class="string">&quot;wangcai&quot;</span>);</span><br><span class="line">    weight:<span class="number">100</span>;</span><br><span class="line">    height:<span class="number">100</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> name = d.get_name();</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;dog=&#123;:#?&#125;&quot;</span>,d);</span><br><span class="line">  Dog::show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="枚举"><a class="markdownIt-Anchor" href="#枚举"></a> 枚举</h3>
<table>
<tr><th>操作</th><th>说明</th></tr>
<tr>
<td>定义方式一(C语言方式)</td>
<td>enum IpAddr{V4,V6};<br>struct Ip{kind:IpAddr,addr:String}<br>let ip1=Ip{kind:IpAddr::V4,address:String::from("127.0.0.1"),};
</td>
<tr>
<td>定义方式二(推荐)</td>
<td> enum IpAddr{V4(String),V6(String),};<br>let i=IpAddr::V4(String::from("127.0.0.1"))<br>
</td>
</tr>
</tr>
<tr>
<td>定义不同类型</td>
<td> enum IpAddr{V4(u8,u8,u8,u8,),V6(String),};<br>let ip1=IpAddr::V4(127,0,0,1));<br>let ip2=IpAddr::V6(String::from("::1")));
</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
<ul>
<li>用法</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span>&#123;</span><br><span class="line">  Quit,  <span class="comment">//等同于类单元结构体QuitMessage</span></span><br><span class="line">  Move&#123;x:<span class="built_in">i32</span>,y:<span class="built_in">i32</span>&#125;, <span class="comment">//结构体MoveMessage</span></span><br><span class="line">  Write(<span class="built_in">String</span>),  <span class="comment">//元组WriteMessage</span></span><br><span class="line">  Change(<span class="built_in">i32</span>,<span class="built_in">i32</span>,<span class="built_in">i32</span>),<span class="comment">//元组结构体ChangeMessage</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>方法及模式匹配</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">impl</span> Message&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">print</span></span>(&amp;<span class="keyword">self</span>)&#123; <span class="comment">//取引用</span></span><br><span class="line">    <span class="keyword">match</span> *<span class="keyword">self</span>&#123; <span class="comment">// 获取内容需要解引用</span></span><br><span class="line">      Message::Quit=&gt;<span class="built_in">println!</span>(<span class="string">&quot;Quit&quot;</span>),</span><br><span class="line">      Message::Move&#123;x,y&#125;=&gt;<span class="built_in">println!</span>(<span class="string">&quot;Move(&#123;&#125;,&#123;&#125;)&quot;</span>,x,y),</span><br><span class="line">      Message::Change(a,b,c)=&gt;<span class="built_in">println!</span>(<span class="string">&quot;change(&#123;&#125;,&#123;&#125;,&#123;&#125;)&quot;</span>,a,b,c),</span><br><span class="line">      <span class="comment">// Message::Write(&amp;s)=&gt;println!(&quot;write(&#123;&#125;)&quot;,s), 引用无法打印</span></span><br><span class="line">      _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;write()&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span>  quit= Message::Quit;</span><br><span class="line">  quit.print();</span><br><span class="line">  <span class="keyword">let</span> mov1 = Message::Move&#123;x:<span class="number">10</span>,y:<span class="number">1</span>&#125;;</span><br><span class="line">  mov1.print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="option"><a class="markdownIt-Anchor" href="#option"></a> Option</h3>
<ul>
<li>标准库定义的一个枚举，原始形式：<code>enum Option&lt;T&gt;&#123;Some(T),None,&#125;</code>，T表示泛型</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> some_number=<span class="literal">Some</span>(<span class="number">5</span>); <span class="comment">//自动推导类型</span></span><br><span class="line">  <span class="keyword">let</span> some_string=<span class="literal">Some</span>(<span class="built_in">String</span>::from(<span class="string">&quot;s&quot;</span>)); </span><br><span class="line">  <span class="keyword">let</span> none_number:<span class="built_in">Option</span>&lt;<span class="built_in">i32</span>&gt; = <span class="literal">None</span>;</span><br><span class="line">  <span class="keyword">let</span> x:<span class="built_in">i32</span> = <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">let</span> y:<span class="built_in">Option</span>&lt;<span class="built_in">i32</span>&gt;=<span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line">  <span class="comment">//let sum = x+y; //error, 两者是不同类型</span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> temp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">match</span> y&#123;</span><br><span class="line">    <span class="literal">Some</span>(i)=&gt;&#123;temp=i;&#125;,</span><br><span class="line">    <span class="literal">None</span>=&gt;&#123;&#125;, <span class="comment">//匹配不全时会报错</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(value)=plus_one(y)&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;value=&#123;&#125;&quot;</span>,value);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;   <span class="comment">//不匹配也不会报错</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;none&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> sum = x+temp;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;sum=&#123;&#125;&quot;</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">plus_one</span></span>(x:<span class="built_in">Option</span>&lt;<span class="built_in">i32</span>&gt;)-&gt;<span class="built_in">Option</span>&lt;<span class="built_in">i32</span>&gt;&#123;</span><br><span class="line">  <span class="keyword">match</span> x&#123;</span><br><span class="line">    <span class="literal">None</span>=&gt;<span class="literal">None</span>,</span><br><span class="line">    <span class="literal">Some</span>(x)=&gt;<span class="literal">Some</span>(x+<span class="number">1</span>),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="vector"><a class="markdownIt-Anchor" href="#vector"></a> vector</h3>
<table>
<thead>
<tr>
<th>操作</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>创建空的vector</td>
<td><code>Vec&lt;T&gt;</code><br><code>let mut v:Vec&lt;i32&gt;=Vec::new();</code></td>
</tr>
<tr>
<td>创建包含初值的vector</td>
<td><code>Vec&lt;T&gt;</code><br><code>let mut v=vec![1,2,3];</code></td>
</tr>
<tr>
<td>压栈</td>
<td><code>v.push(1);</code></td>
</tr>
<tr>
<td>丢弃vector</td>
<td>会丢弃全部元素，<code>&#123;let v1=vec![1];&#125;</code></td>
</tr>
<tr>
<td>读取</td>
<td>方式一：<code>let one:&amp;i32=&amp;v[0];</code><br>方式二(推荐)：<code>match v.get(1)&#123;Some(value)=&gt;println!(&quot;two=&#123;&#125;&quot;,value),_=&gt;&#123;&#125;,&#125;</code></td>
</tr>
<tr>
<td>遍历</td>
<td>不可变遍历<code>for i in &amp;v&#123;println!(&quot;i=&#123;&#125;&quot;,i);&#125;</code><br>可变遍历<code>for i in &amp;mut v&#123;*i+=1;&#125;</code></td>
</tr>
<tr>
<td>存储不同的类型</td>
<td>利用枚举存储不同的类型，<code>enum Context&#123;Text(String),FLoat(f32),Int(i32),&#125;;</code><br><code>let c=vec![Context::Text(String::from(&quot;1&quot;)),Context::Float(1.2),Int(12),];</code></td>
</tr>
</tbody>
</table>
<h3 id="hashmap"><a class="markdownIt-Anchor" href="#hashmap"></a> hashmap</h3>
<ul>
<li><code>HashMap&lt;Key,Value&gt;</code></li>
</ul>
<table>
<thead>
<tr>
<th>操作</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>导入包</td>
<td><code>use std::collections::HashMap;</code></td>
</tr>
<tr>
<td>创建</td>
<td>方式一：<code>let mut map:HashMap&lt;String,i32&gt;=HashMap::new();</code><br>方式二：<code>let keys=vec![String::from(&quot;1&quot;)];let values=vec![1];let map:HashMap&lt;String,i32&gt;=kes.iter().zip(values.iter()).collect();</code></td>
</tr>
<tr>
<td>直接插入</td>
<td><code>map.insert(String::from(&quot;1&quot;),1);</code></td>
</tr>
<tr>
<td>不存在时插入</td>
<td><code>map.entry(String::from(&quot;2&quot;)).or_insert(2);</code></td>
</tr>
<tr>
<td>更新插入</td>
<td><code>let count=map.entry(String::from(&quot;1&quot;)).or_insert(0);*count+=1;</code></td>
</tr>
<tr>
<td>读取</td>
<td><code>let k=String::from(&quot;1&quot;);if let Some(v)=map.get(&amp;k)&#123;println!(&quot;v=&#123;&#125;&quot;,v);&#125;</code></td>
</tr>
<tr>
<td>遍历</td>
<td><code>for (k,v) in &amp;map&#123;println!(&quot;&#123;&#125;:&#123;&#125;&quot;,k,v);&#125;</code><br><code>println!(&quot;&#123;:?&#125;,map&quot;);</code></td>
</tr>
</tbody>
</table>
<h2 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h2>
<ul>
<li>函数定义：<code>fn f1()&#123;&#125;</code></li>
<li>函数调用</li>
<li>参数传入：<code>fn f1(a:i32,b:u32)&#123;&#125;</code>参数定义时需要类型，无法自动推导</li>
<li>返回值：
<ul>
<li>方法一：<code>fn f1(a:i32,b:i32)-&gt;i32&#123;return a+b;&#125;</code></li>
<li>方法二：<code>fn f1(a:i32,b:i32)-&gt;i32&#123;a+b&#125;</code> 语句没有返回值，所以不能有分号</li>
<li>表达式是有返回值的：<code>let y = &#123;let a=1;a+1&#125;;</code></li>
</ul>
</li>
</ul>
<h2 id="注释"><a class="markdownIt-Anchor" href="#注释"></a> 注释</h2>
<ul>
<li><code>//</code></li>
</ul>
<h2 id="控制流"><a class="markdownIt-Anchor" href="#控制流"></a> 控制流</h2>
<h3 id="if"><a class="markdownIt-Anchor" href="#if"></a> if</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> y=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> y==<span class="number">1</span>&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;y==1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> y==<span class="number">0</span>&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;y==0&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;y!=1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//let中使用if</span></span><br><span class="line"><span class="keyword">let</span> condition=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> x=<span class="keyword">if</span> condition&#123;</span><br><span class="line">  <span class="number">5</span> <span class="comment">// 类型要保证一致</span></span><br><span class="line">  <span class="comment">//&quot;5&quot; error</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="number">6</span></span><br><span class="line">&#125;;</span><br><span class="line">println1(<span class="string">&quot;x=&#123;&#125;&quot;</span>,x);</span><br></pre></td></tr></table></figure>
<h3 id="loop"><a class="markdownIt-Anchor" href="#loop"></a> loop</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> counter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">loop</span>&#123;</span><br><span class="line">  counter+=<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> counter&gt;=<span class="number">10</span>&#123;</span><br><span class="line">    <span class="keyword">break</span>;  <span class="comment">//无返回值</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> res = <span class="keyword">loop</span>&#123;</span><br><span class="line">  counter+=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> counter&gt;=<span class="number">20</span>&#123;</span><br><span class="line">    <span class="keyword">break</span> counter*<span class="number">2</span>; <span class="comment">//返回值counter*2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="while"><a class="markdownIt-Anchor" href="#while"></a> while</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> i!=<span class="number">10</span>&#123;</span><br><span class="line">  i+=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="for"><a class="markdownIt-Anchor" href="#for"></a> for</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr:[<span class="built_in">u32</span>;<span class="number">5</span>]=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="comment">// for i in arr.iter()&#123;  //使用迭代器</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &amp;arr()&#123;   <span class="comment">//使用引用</span></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="match"><a class="markdownIt-Anchor" href="#match"></a> match</h3>
<ul>
<li>类似于switch</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">match</span> a&#123;</span><br><span class="line">  <span class="number">1</span>=&gt;<span class="built_in">println!</span>(<span class="string">&quot;1&quot;</span>),</span><br><span class="line">  <span class="number">2</span>=&gt;<span class="built_in">println!</span>(<span class="string">&quot;2&quot;</span>),</span><br><span class="line">  _=&gt;<span class="built_in">println!</span>(<span class="string">&quot;default&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="所有权"><a class="markdownIt-Anchor" href="#所有权"></a> 所有权</h1>
<ul>
<li>rust使用所有权机制管理内存，编译器在编译就会根据所有权对内存的使用进行检测</li>
</ul>
<h2 id="堆和栈"><a class="markdownIt-Anchor" href="#堆和栈"></a> 堆和栈</h2>
<ul>
<li>编译的时候，数据类型大小是固定的，就是分配在栈上，反之就是堆上</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x:<span class="built_in">i32</span>=<span class="number">1</span>; <span class="comment">// 栈上</span></span><br><span class="line"><span class="keyword">let</span> s1=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>); <span class="comment">// string类型长度不确定，堆上</span></span><br></pre></td></tr></table></figure>
<h2 id="变量作用域"><a class="markdownIt-Anchor" href="#变量作用域"></a> 变量作用域</h2>
<ul>
<li>作用域范围：<code>&#123;&#125;</code></li>
</ul>
<h3 id="函数的作用域"><a class="markdownIt-Anchor" href="#函数的作用域"></a> 函数的作用域：</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">ownership</span></span>(s:<span class="built_in">String</span>)&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;s=&#123;&#125;&quot;</span>,s); <span class="comment">//退出后s就被回收了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">unownership</span></span>(s:<span class="built_in">String</span>)-&gt;<span class="built_in">String</span>&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;s=&#123;&#125;&quot;</span>,s); <span class="comment">//退出后将参数传回</span></span><br><span class="line">  s</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">copyi</span></span>(i:<span class="built_in">i32</span>)&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;i=&#123;&#125;&quot;</span>,i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> s=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> s2=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> i=<span class="number">5</span>;</span><br><span class="line">  ownership(s); <span class="comment">//调用后就回收了</span></span><br><span class="line">  unownership(s2);</span><br><span class="line">  copyi(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="移动和拷贝"><a class="markdownIt-Anchor" href="#移动和拷贝"></a> 移动和拷贝</h3>
<ul>
<li>堆上的移动后原来变量无效，反之多次释放同一块内存；</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>); <span class="comment">// string类型长度不确定，堆上</span></span><br><span class="line"><span class="keyword">let</span> s2=s1;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;s2=&#123;&#125;&quot;</span>,s2);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;s1=&#123;&#125;&quot;</span>,s1); <span class="comment">// error,value borrowed here after moved</span></span><br><span class="line"><span class="comment">//防止drop时，重复析构，默认移动后s1就无效了</span></span><br></pre></td></tr></table></figure>
<ul>
<li>堆上的克隆相当于深拷贝；</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s1=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>); <span class="comment">// string类型长度不确定，堆上</span></span><br><span class="line"><span class="keyword">let</span> s2=s1.clone();</span><br></pre></td></tr></table></figure>
<ul>
<li>栈上的拷贝可以继续使用，或者实现了copy特征的类型也无需clone，包括：整型、浮点、布尔、字符、元组；</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> b=a;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;a=&#123;&#125;,b=&#123;&#125;&quot;</span>,a,b);</span><br></pre></td></tr></table></figure>
<h2 id="引用和借用"><a class="markdownIt-Anchor" href="#引用和借用"></a> 引用和借用</h2>
<ul>
<li>引用：<code>&amp; name</code></li>
<li>解引用：<code>* name</code>，取里面的内容</li>
<li>借用：<code>&amp;mut name</code></li>
<li>创建一个指向值的引用，但并不拥有这个值，所以离开作用域不会被释放；</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calcute_len</span></span>(s:&amp;<span class="built_in">String</span>)-&gt;<span class="built_in">usize</span>&#123; <span class="comment">//引用</span></span><br><span class="line">  s.len()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// fn modify_s(s:&amp;String)&#123; //error 修改时需要借用</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">modify_s</span></span>(s:&amp;<span class="keyword">mut</span> <span class="built_in">String</span>)&#123; <span class="comment">//修改时需要借用</span></span><br><span class="line">  s.push_str(<span class="string">&quot; world&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s1 = <span class="built_in">String</span>:from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> l1 = calcute_len(&amp;s1);   <span class="comment">//引用</span></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; len is &#123;&#125;&quot;</span>,s1,l1); <span class="comment">// s1仍可用</span></span><br><span class="line">  <span class="comment">// modify_s(&amp;s1); //引用不能修改</span></span><br><span class="line">  modify_s(&amp;<span class="keyword">mut</span> s1);</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; len is &#123;&#125;&quot;</span>,s1,l1); </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>可变引用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">modify_s</span></span>(s:&amp;<span class="keyword">mut</span> <span class="built_in">String</span>)&#123; <span class="comment">//修改时需要借用</span></span><br><span class="line">  s.push_str(<span class="string">&quot; world&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s1 = <span class="built_in">String</span>:from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> ms = &amp;<span class="keyword">mut</span> s1;</span><br><span class="line">  modify_s(&amp;<span class="keyword">mut</span> ms);</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,s1); <span class="comment">// error，可变引用被改变以后，原值不能再使用 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>借用后不能再使用引用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s1 = <span class="built_in">String</span>:from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> r1 = &amp;s1;</span><br><span class="line"><span class="keyword">let</span> r2 = &amp;s1;</span><br><span class="line"><span class="keyword">let</span> r3 = &amp;<span class="keyword">mut</span> s1;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,r1,r2,r3); <span class="comment">// error，可变引用被改变以后，原值不能再使用 </span></span><br></pre></td></tr></table></figure>
<ul>
<li>悬垂引用（Dangling References）</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> ref_s = dangle(); <span class="comment">//error，回传的是一个空指针</span></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,ref_s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">dangle</span></span>()-&gt;<span class="built_in">String</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> s=<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  &amp;s  <span class="comment">//回传后s被释放，&amp;s指向为空</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="包"><a class="markdownIt-Anchor" href="#包"></a> 包</h2>
<ul>
<li>包（Packages）： Cargo 的一个功能，它允许你构建、测试和分享 crate。</li>
<li>Crates ：一个模块的树形结构，它形成了库或二进制项目。</li>
<li>模块（Modules）和 use： 允许你控制作用域和路径的私有性。</li>
<li>路径（path）：一个命名例如结构体、函数或模块等项的方式</li>
</ul>
<h3 id="模块"><a class="markdownIt-Anchor" href="#模块"></a> 模块</h3>
<ul>
<li>mod模块创建默认是私有的，不能直接通过路径调用，需要声明pub</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mod</span> factory&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="keyword">mod</span> produce_refrigerator&#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">produce</span></span>()&#123;</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;refrigerator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mod</span> produce_washing&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">produce</span></span>()&#123;</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;washing&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  factory::produce_refrigerator::produce();</span><br><span class="line">  factory::produce_washing::produce();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="crate"><a class="markdownIt-Anchor" href="#crate"></a> crate</h3>
<ul>
<li>创建库：<code>cargo new --lib mylib</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vi mylib/src/factory.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> produce_refrigerator&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">produce</span></span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;refrigerator&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">mod</span> produce_washing&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">produce</span></span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;washing&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>导出模块</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vi mylib/src/lib.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> factory</span><br></pre></td></tr></table></figure>
<ul>
<li>配置模块:Cargo.toml</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">mylib</span>=&#123;path=<span class="string">&quot;./mylib&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用库</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vi src/main.rs</span></span><br><span class="line"><span class="keyword">use</span> mylib::factory::produce_refrigerator <span class="keyword">as</span> A;  <span class="comment">// 设置别名</span></span><br><span class="line"><span class="keyword">use</span> mylib::factory::*; <span class="comment">// 导入所有模块</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  mylib::factory::produce_refrigerator::produce(); <span class="comment">//绝对路径</span></span><br><span class="line">  <span class="comment">//produce_refrigerator::produce(); //使用use</span></span><br><span class="line">  A::produce();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="mod的结构体"><a class="markdownIt-Anchor" href="#mod的结构体"></a> mod的结构体</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mod</span> modA&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">pub</span> number:<span class="built_in">i32</span>,</span><br><span class="line">    name:<span class="built_in">String</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">impl</span> A&#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">new_a</span></span>()-&gt; A&#123;</span><br><span class="line">      A&#123;</span><br><span class="line">        number:<span class="number">1</span>,</span><br><span class="line">        name:<span class="built_in">String</span>::from(<span class="string">&quot;啊&quot;</span>),</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">print</span></span>()&#123;</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>,<span class="keyword">self</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> a = modA::A::new_a();</span><br><span class="line">  a.print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>访问上一级的模块</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> modB&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">print</span></span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">pub</span> <span class="keyword">mod</span> modC&#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">print</span></span>()&#123;</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">      super::print();  <span class="comment">//父模块函数</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="外部库"><a class="markdownIt-Anchor" href="#外部库"></a> 外部库</h3>
<ul>
<li>引入rustcrypto，在Cargo.toml添加引用</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">rust-crypto</span>=<span class="string">&quot;0.2&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在代码中引用</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//src/main.rs</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">crate</span> crypto;</span><br><span class="line"><span class="keyword">use</span> crypto::digest::Digest;</span><br><span class="line"><span class="keyword">use</span> crypto::sha3::Sha3;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> hasher=Sha3:sha3_256();</span><br><span class="line">  hasher.input_str(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> res = hasher.result_str();</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;res=&#123;&#125;&quot;</span>,res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>执行<code>cargo run</code>时，相应的库会自动下载和编译。</li>
</ul>
<h2 id="错误"><a class="markdownIt-Anchor" href="#错误"></a> 错误</h2>
<ul>
<li>rust的错误分为：
<ul>
<li>可恢复错误：用户报告的错误和重试操作是否合理，用枚举<code>Result&lt;T,E&gt;</code>实现</li>
<li>不可恢复错误：通过<code>panic! unwrap expect</code>实现</li>
</ul>
</li>
</ul>
<h3 id="panic"><a class="markdownIt-Anchor" href="#panic"></a> panic!</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="built_in">panic!</span>(<span class="string">&quot;crash!!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="rust_backtrace"><a class="markdownIt-Anchor" href="#rust_backtrace"></a> RUST_BACKTRACE</h3>
<ul>
<li><code>RUST_BACKTRACE=1 cargo run</code>执行时会打印调试堆栈，非0即可</li>
</ul>
<h3 id="resultte"><a class="markdownIt-Anchor" href="#resultte"></a> Result&lt;T,E&gt;</h3>
<ul>
<li>原型</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Result</span></span>&lt;T,E&gt;&#123;</span><br><span class="line">  <span class="literal">Ok</span>(T),</span><br><span class="line">  <span class="literal">Err</span>(E),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> f=File::open(<span class="string">&quot;hello.txt&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> r = <span class="keyword">match</span> f&#123;</span><br><span class="line">    <span class="literal">Ok</span>(file)=&gt;file;</span><br><span class="line">    Error(error)=&gt;<span class="built_in">panic!</span>(<span class="string">&quot;error:&#123;:?&#125;&quot;</span>,error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>简写方式</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="comment">//方式一</span></span><br><span class="line">  <span class="keyword">let</span> f=File::open(<span class="string">&quot;hello.txt&quot;</span>).unwrap();</span><br><span class="line">  <span class="comment">//方式二</span></span><br><span class="line">  <span class="keyword">let</span> f=File::open(<span class="string">&quot;hello.txt&quot;</span>).expect(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="错误传递"><a class="markdownIt-Anchor" href="#错误传递"></a> 错误传递</h3>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> std::io::Read;</span><br><span class="line"><span class="keyword">use</span> std::io::File;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> r = read_username();</span><br><span class="line">  <span class="keyword">match</span> r&#123;</span><br><span class="line">    <span class="literal">Ok</span>(s)=&gt;<span class="built_in">println!</span>(<span class="string">&quot;s=&#123;&#125;&quot;</span>,s);</span><br><span class="line">    <span class="literal">Err</span>(e)=&gt;<span class="built_in">println!</span>(<span class="string">&quot;error:&#123;:?&#125;&quot;</span>,e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username</span></span>()-&gt;<span class="built_in">Result</span>&lt;<span class="built_in">String</span>,io::Error&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> f=File::open(<span class="string">&quot;hello.txt&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> f = <span class="keyword">match</span> f&#123;</span><br><span class="line">    <span class="literal">Ok</span>(file)=&gt;file,</span><br><span class="line">    <span class="literal">Err</span>(error)=&gt;<span class="keyword">return</span> <span class="literal">Err</span>(error),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s=<span class="built_in">String</span>::new();</span><br><span class="line">  <span class="keyword">match</span> f.read_to_string(&amp;<span class="keyword">mut</span> s)&#123;</span><br><span class="line">    <span class="literal">Ok</span>(_)=&gt;<span class="literal">Ok</span>(s),</span><br><span class="line">    <span class="literal">Err</span>(error)=&gt;<span class="literal">Err</span>(error),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简写方式1</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username2</span></span>()-&gt;<span class="built_in">Result</span>&lt;<span class="built_in">String</span>,io::Error&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> f=File::open(<span class="string">&quot;hello.txt&quot;</span>)?;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s=<span class="built_in">String</span>::new();</span><br><span class="line">  <span class="keyword">match</span> f.read_to_string(&amp;<span class="keyword">mut</span> s)?</span><br><span class="line">  <span class="literal">Ok</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简写方式2</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username2</span></span>()-&gt;<span class="built_in">Result</span>&lt;<span class="built_in">String</span>,io::Error&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s=<span class="built_in">String</span>::new();</span><br><span class="line">  File::open(<span class="string">&quot;hello.txt&quot;</span>)?.read_to_string(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">  <span class="literal">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="测试"><a class="markdownIt-Anchor" href="#测试"></a> 测试</h2>
<ul>
<li>执行<code>cargo new --lib mylib</code></li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//mylib/src/animal.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> Dog&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">hello</span></span>()-&gt;<span class="built_in">bool</span>&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;wang&quot;</span>);</span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> Cat&#123;</span><br><span class="line">  <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">hello</span></span>()-&gt;<span class="built_in">bool</span>&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;miao&quot;</span>);</span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//mylib/src/lib.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> animal</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests&#123;</span><br><span class="line">  <span class="keyword">use</span> crate::animal::*;</span><br><span class="line">  <span class="meta">#[test]</span></span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">it_works</span></span>()&#123;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">2</span>+<span class="number">2</span>,<span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#[test]</span></span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">use_cat</span></span>()&#123;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="literal">true</span>,Cat::hello());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>执行测试：<code>cargo test</code></li>
</ul>
<h1 id="泛型"><a class="markdownIt-Anchor" href="#泛型"></a> 泛型</h1>
<ul>
<li>泛型是具体类型或其他属性的抽象替代。减少代码重复</li>
<li>泛型不会导致程序性能损失，rust在编译过程会对泛型进行单态化，转化为特定代码。</li>
</ul>
<h2 id="使用泛型"><a class="markdownIt-Anchor" href="#使用泛型"></a> 使用泛型</h2>
<ul>
<li>函数定义</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">//泛型满足特征：PartialOrd可排序，Copy有copy特征</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T:<span class="built_in">PartialOrd</span>+<span class="built_in">Copy</span>&gt;(list:&amp;[T])-&gt;T&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> larger=list[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter()&#123;</span><br><span class="line">    <span class="keyword">if</span> item&gt;larger&#123;</span><br><span class="line">      larger=item;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  larger</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> number_list = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">23</span>,<span class="number">324</span>,<span class="number">23</span>,<span class="number">4235</span>];</span><br><span class="line">  <span class="keyword">let</span> max_num = largest(&amp;number_list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>结构体</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T&gt;&#123;</span><br><span class="line">  x:T,</span><br><span class="line">  y:T,</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point2d</span></span>&lt;T,U&gt;&#123;</span><br><span class="line">  x:T,</span><br><span class="line">  y:U,</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> p1=Point&#123;x:<span class="number">1</span>,y:<span class="number">2</span>&#125;;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;:#?&#125;&quot;</span>,p1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>枚举</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option</span></span>&lt;T&gt;&#123;</span><br><span class="line">  <span class="literal">Some</span>(T),</span><br><span class="line">  <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Result</span></span>&lt;T,E&gt;&#123;</span><br><span class="line">  <span class="literal">Ok</span>(T),</span><br><span class="line">  <span class="literal">Err</span>(E),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T&gt;&#123;</span><br><span class="line">  x:T,</span><br><span class="line">  y:T,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; Point&lt;T&gt;&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_x</span></span>(&amp;<span class="keyword">self</span>)-&gt;&amp;T&#123;</span><br><span class="line">    $<span class="keyword">self</span>.x</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_y</span></span>(&amp;<span class="keyword">self</span>)-&gt;&amp;T&#123;</span><br><span class="line">    $<span class="keyword">self</span>.y</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> p=Point(x:<span class="number">1</span>,y:<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;x=&#123;&#125;,y=&#123;&#125;&quot;</span>,p.get_x(),p.get_y());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="特征trait"><a class="markdownIt-Anchor" href="#特征trait"></a> 特征trait</h1>
<ul>
<li>trait 告诉 Rust 编译器某个特定类型拥有可能与其他类型共享的功能。类似于接口interface</li>
<li>通过trait以抽象的方式定义共享的行为</li>
<li>trait bounds指定泛型是任何拥有特定行为的类型</li>
</ul>
<h2 id="使用"><a class="markdownIt-Anchor" href="#使用"></a> 使用</h2>
<ul>
<li>定义</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">GetInfo</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_name</span></span>(&amp;<span class="keyword">self</span>)-&gt;&amp;<span class="built_in">String</span>;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_age</span></span>(&amp;<span class="keyword">self</span>)-&gt;<span class="built_in">u32</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实现</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">  <span class="keyword">pub</span> name:<span class="built_in">String</span>,</span><br><span class="line">  <span class="keyword">pub</span> age:<span class="built_in">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> GetIfo <span class="keyword">for</span> Student&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_name</span></span>(&amp;<span class="keyword">self</span>)-&gt;&amp;<span class="built_in">String</span>&#123;</span><br><span class="line">    &amp;<span class="keyword">self</span>.name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_age</span></span>(&amp;<span class="keyword">self</span>)-&gt;<span class="built_in">u32</span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> s=Student&#123;name:<span class="string">&quot;xiao&quot;</span>.to_string(),age=<span class="number">13</span>&#125;;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;name=&#123;&#125;,age=&#123;&#125;&quot;</span>,s.get_name(),s.get_age());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>trait作为参数</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">print_info</span></span>(item:<span class="keyword">impl</span> GetInfo)&#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;name=&#123;&#125;,age=&#123;&#125;&quot;</span>,s.get_name(),s.get_age());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>默认实现</li>
</ul>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">SchoolName</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">fn</span> <span class="title">get_school_name</span></span>(&amp;<span class="keyword">self</span>)-&gt;<span class="built_in">String</span>&#123;</span><br><span class="line">    <span class="built_in">String</span>::from(<span class="string">&quot;school&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="生命周期"><a class="markdownIt-Anchor" href="#生命周期"></a> 生命周期</h1>
<h1 id="迭代器"><a class="markdownIt-Anchor" href="#迭代器"></a> 迭代器</h1>
<h1 id="智能指针"><a class="markdownIt-Anchor" href="#智能指针"></a> 智能指针</h1>
<h1 id="线程"><a class="markdownIt-Anchor" href="#线程"></a> 线程</h1>
<h1 id="面向对象"><a class="markdownIt-Anchor" href="#面向对象"></a> 面向对象</h1>
<h1 id="高级特征"><a class="markdownIt-Anchor" href="#高级特征"></a> 高级特征</h1>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/language/">language</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2021/07/28/%E6%9B%B2%E7%BA%BF%E6%8A%BD%E7%A8%80/"><span>曲线抽稀</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'false' == 'true';
var verify = 'false' == 'true';
var record_ip = '' == 'true';
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  recordIP:record_ip,
  appId:'AdfkiqY89QUSUWbDY9xJuCh0-gzGzoHsz',
  appKey:'2cEvHcqEWsyoKwy4AUL3kPGh',
  placeholder:'劈个叉吧',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'100',
  lang: 'zh-cn'
})</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2021 By hero576</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.2"></script><script src="/js/fancybox.js?version=1.8.2"></script><script src="/js/sidebar.js?version=1.8.2"></script><script src="/js/copy.js?version=1.8.2"></script><script src="/js/fireworks.js?version=1.8.2"></script><script src="/js/transition.js?version=1.8.2"></script><script src="/js/scroll.js?version=1.8.2"></script><script src="/js/head.js?version=1.8.2"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>